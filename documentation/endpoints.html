<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>REST API Documentation - Balmer REST Service</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        padding: 20px;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f8f9fa;
      }
      .container {
        background-color: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        max-width: 1600px;
      }
      h1 {
        color: #2c3e50;
        margin-bottom: 30px;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
      }
      .badge-get {
        background-color: #61affe;
      }
      .badge-post {
        background-color: #49cc90;
      }
      .badge-delete {
        background-color: #f93e3e;
      }
      .method-badge {
        min-width: 80px;
        display: inline-block;
        text-align: center;
      }
      .table th {
        background-color: #2980b9;
        color: white;
      }
      .table thead {
        background-color: #2980b9;
      }
      tr:hover {
        background-color: #f8f9fa;
      }
      .endpoint-url {
        font-family: monospace;
        font-weight: bold;
        color: #333;
      }
      .footer {
        margin-top: 40px;
        font-size: 0.9em;
        text-align: center;
        color: #6c757d;
      }
      pre {
        background: #f4f4f4;
        padding: 10px;
        border-radius: 4px;
        font-size: 0.8em;
        margin: 0;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      .io-cell {
        max-width: 250px;
      }
      .backend-url {
        font-family: monospace;
        font-size: 0.75em;
        color: #6c3483;
      }
      .section-header {
        background-color: #1a5276 !important;
        color: white;
      }
      .section-header td {
        font-weight: bold;
        font-size: 1.1em;
      }
      .base-url-note {
        font-size: 0.85em;
        background: #3498db20;
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 20px;
        border-left: 4px solid #3498db;
      }
      code {
        background: #eee;
        padding: 2px 6px;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>REST API Documentation</h1>

      <div class="alert alert-info" role="alert">
        <strong>Project:</strong> Balmer REST Service<br />
        <strong>Generated on:</strong> <span id="date"></span>
      </div>

      <div class="base-url-note">
        <strong>Backend Base URL:</strong><br />
        <code>iBPS:</code>
        <span class="backend-url"
          >${ibps.base.url}/iBPSRestFulWebServices/ibps/Restful/{cabinet}</span
        >
      </div>

      <div class="table-responsive">
        <table class="table table-bordered align-middle">
          <thead>
            <tr>
              <th style="width: 6%">Method</th>
              <th style="width: 14%">Endpoint</th>
              <th style="width: 14%">Description</th>
              <th style="width: 22%" class="io-cell">Input</th>
              <th style="width: 22%" class="io-cell">Output</th>
              <th style="width: 22%">Backend iBPS URL</th>
            </tr>
          </thead>
          <tbody>
            <!-- Authentication Section -->
            <tr class="section-header">
              <td colspan="6">Authentication</td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/login-wmConnectCabinet</td>
              <td>Login to WMConnect Cabinet</td>
              <td class="io-cell">
                <pre>{ "userName": "string", "password": "string" }</pre>
              </td>
              <td class="io-cell">
                <pre>{ "wmConnectResponse": {...}, "userDetails": {...} }</pre>
              </td>
              <td class="backend-url">
                /WMConnect/?engineName={engine}&userName={user}&UserExist=N
              </td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/disconnect</td>
              <td>Logout User</td>
              <td class="io-cell">
                <pre>
Query: name=string
Header: sessionId</pre
                >
              </td>
              <td class="io-cell"><pre>string (Success/Error)</pre></td>
              <td class="backend-url">
                /WMDisconnect?engineName={engine}&name={user}
              </td>
            </tr>

            <!-- Session Management Section -->
            <tr class="section-header">
              <td colspan="6">Session Management</td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/session</td>
              <td>Get or Create Session (Cached)</td>
              <td class="io-cell">
                <pre>{ "userName": "string", "password": "string" }</pre>
              </td>
              <td class="io-cell">
                <pre>
{ "success": true, "sessionId": 123, "userName": "...", "remainingMinutes": 25, "cached": true, "userDetails": {...} }</pre
                >
              </td>
              <td class="backend-url">
                /WMConnect/?engineName={engine}&userName={user}&UserExist=N<br />(cached
                internally)
              </td>
            </tr>
            <tr>
              <td>
                <span class="badge badge-delete method-badge">DELETE</span>
              </td>
              <td class="endpoint-url">/session</td>
              <td>Invalidate Session</td>
              <td class="io-cell"><pre>Query: userName=string</pre></td>
              <td class="io-cell">
                <pre>
{ "success": true, "message": "Session invalidated..." }</pre
                >
              </td>
              <td class="backend-url">Local cache only (no backend call)</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/session/info</td>
              <td>Get Session Info</td>
              <td class="io-cell"><pre>Query: userName=string</pre></td>
              <td class="io-cell">
                <pre>
{ "exists": true, "sessionId": 123, "createdAt": "...", "remainingMinutes": 20, "isValid": true }</pre
                >
              </td>
              <td class="backend-url">Local cache only (no backend call)</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/session/stats</td>
              <td>Get Session Cache Stats</td>
              <td class="io-cell"><pre>None</pre></td>
              <td class="io-cell">
                <pre>{ "cacheSize": 5, "timeoutMinutes": 25 }</pre>
              </td>
              <td class="backend-url">Local cache only (no backend call)</td>
            </tr>

            <!-- Queue Management Section -->
            <tr class="section-header">
              <td colspan="6">Queue Management</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/queue/myqueue</td>
              <td>Get My Queue Work Items</td>
              <td class="io-cell"><pre>Header: sessionId</pre></td>
              <td class="io-cell">
                <pre>{ "success": true, "workItems": [...] }</pre>
              </td>
              <td class="backend-url">
                /WMFetchWorkList/?engineName={engine}&queueId=0<br />(MyQueueFlag=Y)
              </td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/queue/commonqueue</td>
              <td>Get Common Queue Work Items</td>
              <td class="io-cell"><pre>Header: sessionId</pre></td>
              <td class="io-cell">
                <pre>{ "success": true, "workItems": [...] }</pre>
              </td>
              <td class="backend-url">
                /WMGetQueueList/?engineName={engine}<br />/WMFetchWorkList/?engineName={engine}&queueId={id}
              </td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/queue/allworkitems</td>
              <td>Get All Work Items (My + Common)</td>
              <td class="io-cell"><pre>Header: sessionId</pre></td>
              <td class="io-cell">
                <pre>
{ "success": true, "workItems": [...], "myQueueCount": n, "commonQueueCount": m }</pre
                >
              </td>
              <td class="backend-url">
                /WMFetchWorkList/?engineName={engine}&queueId=0<br />/WMGetQueueList/?engineName={engine}<br />/WMFetchWorkList/?engineName={engine}&queueId={id}
              </td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/queue/list</td>
              <td>Get User's Accessible Queues</td>
              <td class="io-cell"><pre>Header: sessionId</pre></td>
              <td class="io-cell">
                <pre>{ "success": true, "queues": [...] }</pre>
              </td>
              <td class="backend-url">
                /WMGetQueueList/?engineName={engine}<br />(QueueAssociation=2)
              </td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/queue/{queueId}/items</td>
              <td>Get Work Items from Specific Queue</td>
              <td class="io-cell">
                <pre>
Path: queueId
Query: queueName (optional)
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>{ "success": true, "workItems": [...] }</pre>
              </td>
              <td class="backend-url">
                /WMFetchWorkList/?engineName={engine}&queueId={queueId}
              </td>
            </tr>
            <!-- Notesheet Management Section -->
            <tr class="section-header">
              <td colspan="6">Notesheet Management</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/notesheet/getoriginal</td>
              <td>Get Original Notesheet PDF</td>
              <td class="io-cell">
                <pre>
Query: workitemId=string
Query: processInstanceId=string
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>{ "success": true, "found": true, "filePath": "..." }</pre>
              </td>
              <td class="backend-url">
                /NGOGetDocument (Cabinet/Folder/Version derived)
              </td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/notesheet/getannotations</td>
              <td>Get Document Annotations</td>
              <td class="io-cell">
                <pre>
Query: documentIndex=string
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>{ "success": true, "annotations": {...} }</pre>
              </td>
              <td class="backend-url">/NGOGetAnnotationGroupList</td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/notesheet/setannotations</td>
              <td>Set Document Annotations</td>
              <td class="io-cell">
                <pre>
Query: documentIndex=string
Header: sessionId
Body: JSON (annotations)</pre
                >
              </td>
              <td class="io-cell">
                <pre>
{ "success": true, "processedCount": 1, "results": [...] }</pre
                >
              </td>
              <td class="backend-url">/NGOAddAnnotation</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/notesheet/getcomments</td>
              <td>Get Work Item Comments</td>
              <td class="io-cell">
                <pre>
Query: workitemId, processInstanceId
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>{ "success": true, "count": 2, "comments": [...] }</pre>
              </td>
              <td class="backend-url">/WMFetchWorkItemAttributes</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/notesheet/getnotesheet</td>
              <td>Get Notesheet Document ID</td>
              <td class="io-cell">
                <pre>
Query: workitemId, processInstanceId
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>
{
  "success": true,
  "found": true,
  "documentIndex": "1668",
  "folderIndex": "1477",
  "versionNo": "1"
}</pre
                >
              </td>
              <td class="backend-url">/WMFetchWorkItemAttributes</td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/docs/checkoutcheckinwithanno</td>
              <td>Checkout, Checkin with Annotations</td>
              <td class="io-cell">
                <pre>
Query: documentIndex, contentPath
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>
{
  "success": true,
  "documentIndex": "1668",
  "newVersion": "1.4",
  "annotationsBackedUp": true,
  "annotationsRestored": true,
  "annotationBackupPath": "/tmp/..."
}</pre
                >
              </td>
              <td class="backend-url">/executeAPIJSON, /checkInDocumentJSON</td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/notesheet/createpdfnote</td>
              <td>Create PDF Note with Supporting Documents and Comments</td>
              <td class="io-cell">
                <pre>
Query: workitemId, processInstanceId
(Uses service account)</pre
                >
              </td>
              <td class="io-cell">
                <pre>
{
  "success": true,
  "originalDocIndex": "1669",
  "notedocumentIndex": "1668",
  "newVersion": "1.5",
  "pdfPath": "/tmp/...",
  "commentsPath": "/tmp/...",
  "annotationsPreserved": true
}</pre
                >
              </td>
              <td class="backend-url">
                getoriginal, getcomments, getnotesheet, getSupportingDocs, checkoutcheckinwithanno
              </td>
            </tr>

            <!-- Supporting Documents Section -->
            <tr class="section-header">
              <td colspan="6">Supporting Documents</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/supportingdocs/list</td>
              <td>List Supporting Documents</td>
              <td class="io-cell">
                <pre>
Query: workitemId, processInstanceId
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>
{
  "success": true,
  "folderId": "1234",
  "processInstanceId": "e-Notes-...",
  "workitemId": "1",
  "count": 2,
  "documents": [
    {
      "documentIndex": "1670",
      "documentName": "Invoice.pdf",
      "documentType": "pdf",
      "documentSize": "245678",
      "createdDateTime": "...",
      "versionNo": "1.0",
      "owner": "user"
    }
  ]
}</pre
                >
              </td>
              <td class="backend-url">
                /WMFetchWorkItemAttributes<br />/NGOGetFolderContents (OmniDocs)
              </td>
            </tr>

            <!-- Document Viewer Section -->
            <tr class="section-header">
              <td colspan="6">Document Viewer (PDF Hyperlinks)</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/docs/viewer</td>
              <td>Document Viewer Login Page</td>
              <td class="io-cell">
                <pre>Query: docIndex=string</pre>
              </td>
              <td class="io-cell">
                <pre>HTML Login Page
(Redirects to download after auth)</pre>
              </td>
              <td class="backend-url">Serves static HTML page</td>
            </tr>
            <tr>
              <td><span class="badge badge-post method-badge">POST</span></td>
              <td class="endpoint-url">/docs/viewer/authenticate</td>
              <td>Authenticate and Get Download Token</td>
              <td class="io-cell">
                <pre>
{
  "userName": "string",
  "password": "string",
  "docIndex": "string"
}</pre
                >
              </td>
              <td class="io-cell">
                <pre>
{
  "success": true,
  "downloadUrl": "/docs/download/..."
}</pre
                >
              </td>
              <td class="backend-url">/WMConnect (auth)</td>
            </tr>
            <tr>
              <td><span class="badge badge-get method-badge">GET</span></td>
              <td class="endpoint-url">/docs/download/{docIndex}</td>
              <td>Download Document (Authenticated)</td>
              <td class="io-cell">
                <pre>
Path: docIndex
Header: sessionId</pre
                >
              </td>
              <td class="io-cell">
                <pre>Binary file stream
(Content-Disposition: attachment)</pre>
              </td>
              <td class="backend-url">/getDocumentStreamJSON (OmniDocs)</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="footer">&copy; 2025 Balmer Lawrie & Co. Ltd.</div>
    </div>

    <script>
      document.getElementById("date").innerText =
        new Date().toLocaleDateString() + " " + new Date().toLocaleTimeString();
    </script>
  </body>
</html>
